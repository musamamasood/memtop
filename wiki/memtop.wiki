#summary Displays memory consumption by processes in easy to read way.

= Introduction =

Python script for linux. Intended to help with diagnose and identification which processes uses most of RAM of PC.

Typical situation is when you need to reduce RAM usage of your box. 

It uses output of pmap tool. Use 'pmap -d $PID' and scan last line for 'writeable/private:'.  This number could be interpreted like this: 'If you kill the respective process the overall memory consumption of the box will drop by this value'. Though, memory management is complicated thing :( and I'm far from being an expert. So if you have more question or any doubts about what the numbers present you have to consult pmap manpage.

For latest changes (in v 0.9.2) see the bottom of this page.

<br>

== Example of output ==
One example is better then ten lines of description
{{{
   PID |   private/writ. mem |  command                       22:44:38
       |  current | previous | (truncated)           (waiting 15 min.)
  3343 | 111.9 MB |          | /usr/lib/opera/9.62/opera-styleskulptu
  3283 |  19.8 MB |    ++    | /usr/bin/plasma
  7078 |  18.7 MB |    +     | /usr/bin/pcmanfm
  3292 |  12.4 MB |          | kxkb
  3278 |  11.0 MB |          | ksmserver
  7737 |   9.0 MB |    +++   | python/home/johny/programs/mtvcgui/trun
  3280 |   8.0 MB |    +     | kwin
  3272 |   6.5 MB |          | kded4
  4556 |   3.4 MB |          | /usr/lib/opera/9.62//operapluginwrapper
       RAM usage: |===================    77.6 %

   PID |   private/writ. mem |  command                       22:59:41
       |  current | previous | (truncated)           (waiting 15 min.)
  3343 | 111.9 MB |          | /usr/lib/opera/9.62/opera-styleskulptu
  7078 |  26.9 MB |    +++   | /usr/bin/pcmanfm
  3283 |  19.8 MB |          | /usr/bin/plasma
  3292 |  12.4 MB |          | kxkb
  3278 |  11.0 MB |          | ksmserver
  7737 |   9.0 MB |          | python/home/johny/programs/mtvcgui/trun
  3280 |   8.0 MB |          | kwin
  3272 |   6.5 MB |          | kded4
  4556 |   3.4 MB |          | /usr/lib/opera/9.62//operapluginwrapper
       RAM usage: |====================    78.4 %

   PID |   private/writ. mem |  command                       23:14:44
       |  current | previous | (truncated)           (waiting 15 min.)
  3343 | 111.1 MB |   -      | /usr/lib/opera/9.62/opera-styleskulptu
  7078 |  26.9 MB |          | /usr/bin/pcmanfm
  3283 |  19.8 MB |          | /usr/bin/plasma
  3292 |  12.4 MB |          | kxkb
  3278 |  11.0 MB |          | ksmserver
  7737 |   9.0 MB |          | python/home/johny/programs/mtvcgui/trun
  3280 |   8.0 MB |          | kwin
  3272 |   6.5 MB |          | kded4
  4556 |   3.4 MB |          | /usr/lib/opera/9.62//operapluginwrapper
       RAM usage: |====================    78.1 %
}}}

This example shows "graph" mode, and here the third column "previous" indicates change against previous iteration. It is just to visualise what program (its RAM occupation) is growing or shrinking.

<br>

== Use ==

No installation is needed, just run the script. Available parameters are

|| -p $integer   ||wait time between iterations (in minutes)||
||-s graph|numb||two alternatives how to present mainly data from former iteration||
|| -l $integer||number of lines - processes to show||
||-m ||more info about memory utilization (since 0.9.4)||
||-h||help||



Important note: The script should be *run as root* or you will not get data for processes running under other users.

<br>

== Additional memory utilization info, introduced from 0.9.4 ==

From this release you can use swith "-m"/"-more" to get two additional lines:

{{{
   ...........................
  1156 |  24.7 MB |    ++++  |/usr/sbin/rsyslogd -c4                                                            
 11192 |  21.2 MB |    ++++  |tea                                                                               
    Writeable/RAM: =================================  76.7%
->  RAM use without cached pages: 43.3% , SWAP use: 50.3%
->  Swapping: 0/0, Paging: 0/4 (in/out / sec). Status in words: None or negligible.
}}}

While "writeable" information can be used to track memory use of single processes, especially memory leaks and so, "RAM use without cached pages" gives single number of your physical RAM utilization. It based on /proc/meminfo and consideres three lines:

  * MemTotal - as size of your RAM
  * MemFree  - as free portion of RAM
  * Cached   -  in-memory cache for files read from the disk... this portion of RAM is not reported as free (not included in MemFree) but due to the character of data, kernel can drop stored data immediately and use freed capacity as needed

For SWAP use it uses SwapTotal & SwapFree

Another and last new line is about swapping & paging. This information doesn't say "How full your RAM is" but monitors symptoms of RAM shortage. Here I also added "Text evaluation" of numbers for better. This test examines 5 seconds period but numbers are second averages.

The scale for text evaluation is below. The memtop sums all 4 numbers together and then based on result if:

  * sum < 20 None or negligible.
  * sum < 50 Increased, but still no problem.
  * sum < 150 Something is going on?
  * sum < 600 Swapping/paging intensively!
  * else: System went crazy!!!!

Feel free to suggest any changes to the scale, my experiences with paging are very limited...

<br>

== Why memtop and not (h)top? ==

Thanks for asking this question. Answer is simple, htop offers mutliple types of memory consumption if you are able to understand them, then it is fine. However, if you want only one single number, memtop is for you. 

<br>

== Changes in 0.9.2 ==

This is a new version after some 3 years, I "ported" it to python3 (still working with version 2.7 at least) and fixed problems when grepping its output. Sometimes it did not get through pipe at all (I dont understand why) but the main problem was that the grep command used to return error "Binary file matches". It showed that names of listed programs contained binary characters, not visible in console but still affecting grep.

<br>

**Any comments welcomed!!!**